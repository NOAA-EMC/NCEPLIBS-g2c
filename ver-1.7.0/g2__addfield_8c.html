<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NCEPLIBS-g2c: g2_addfield.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-g2c
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('g2__addfield_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">g2_addfield.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Pack up Sections 4 through 7 for a given field and adds them to a GRIB2 message.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="grib2__int_8h_source.html">grib2_int.h</a>&quot;</code><br />
</div>
<p><a href="g2__addfield_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad403b8c1a156f062c3ded89224e6b46b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="g2__addfield_8c.html#ad403b8c1a156f062c3ded89224e6b46b">g2_addfield</a> (unsigned char *cgrib, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> ipdsnum, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> *ipdstmpl, float *coordlist, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> numcoord, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> idrsnum, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> *idrstmpl, float *fld, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> ngrdpts, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> ibmap, <a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> *bmap)</td></tr>
<tr class="memdesc:ad403b8c1a156f062c3ded89224e6b46b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This routine packs up Sections 4 through 7 for a given field and adds them to a GRIB2 message.  <a href="g2__addfield_8c.html#ad403b8c1a156f062c3ded89224e6b46b">More...</a><br /></td></tr>
<tr class="separator:ad403b8c1a156f062c3ded89224e6b46b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pack up Sections 4 through 7 for a given field and adds them to a GRIB2 message. </p>
<dl class="section author"><dt>Author</dt><dd>Stephen Gilbert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-11-05 </dd></dl>

<p class="definition">Definition in file <a class="el" href="g2__addfield_8c_source.html">g2_addfield.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad403b8c1a156f062c3ded89224e6b46b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad403b8c1a156f062c3ded89224e6b46b">&#9670;&nbsp;</a></span>g2_addfield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> g2_addfield </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>cgrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a>&#160;</td>
          <td class="paramname"><em>ipdsnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> *&#160;</td>
          <td class="paramname"><em>ipdstmpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>coordlist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a>&#160;</td>
          <td class="paramname"><em>numcoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a>&#160;</td>
          <td class="paramname"><em>idrsnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> *&#160;</td>
          <td class="paramname"><em>idrstmpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>fld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a>&#160;</td>
          <td class="paramname"><em>ngrdpts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a>&#160;</td>
          <td class="paramname"><em>ibmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="grib2_8h.html#af0b63b0e0f41f07f562a4367e2a60838">g2int</a> *&#160;</td>
          <td class="paramname"><em>bmap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This routine packs up Sections 4 through 7 for a given field and adds them to a GRIB2 message. </p>
<p>They are <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_sect4.shtml">Product Definition Section</a>, <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_sect5.shtml">Data Representation Section</a>, <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_sect6.shtml">Bit-Map Section</a> and <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_sect7.shtml">Data Section</a>, respectively.</p>
<p>This routine is used with routines <a class="el" href="g2__create_8c.html#a0e8970973e1cefc142240f961a796108" title="This routine initializes a new GRIB2 message and packs GRIB2 Section 0 (Indicator Section) and Sectio...">g2_create()</a>, <a class="el" href="g2__addlocal_8c.html#aa9490d67c089f6a15fd9941f273752c3" title="This routine adds a Local Use Section (Section 2) to a GRIB2 message.">g2_addlocal()</a>, <a class="el" href="g2__addgrid_8c.html#a14908ea75d83021b0ec10ae8c084567c" title="This routine packs up a Grid Definition Section (Section 3) and adds it to a GRIB2 message.">g2_addgrid()</a>, and <a class="el" href="g2__gribend_8c.html#a84081fb5d32251234409b9ec2d72a0e8" title="This routine finalizes a GRIB2 message after all grids and fields have been added.">g2_gribend()</a> to create a complete GRIB2 message. Function <a class="el" href="g2__create_8c.html#a0e8970973e1cefc142240f961a796108" title="This routine initializes a new GRIB2 message and packs GRIB2 Section 0 (Indicator Section) and Sectio...">g2_create()</a> must be called first to initialize a new GRIB2 message. Function <a class="el" href="g2__addgrid_8c.html#a14908ea75d83021b0ec10ae8c084567c" title="This routine packs up a Grid Definition Section (Section 3) and adds it to a GRIB2 message.">g2_addgrid()</a> must be called after <a class="el" href="g2__create_8c.html#a0e8970973e1cefc142240f961a796108" title="This routine initializes a new GRIB2 message and packs GRIB2 Section 0 (Indicator Section) and Sectio...">g2_create()</a> and before this routine to add the appropriate grid description to the GRIB2 message. A call to <a class="el" href="g2__gribend_8c.html#a84081fb5d32251234409b9ec2d72a0e8" title="This routine finalizes a GRIB2 message after all grids and fields have been added.">g2_gribend()</a> is required to complete GRIB2 message after all fields have been added.</p>
<h3><a class="anchor" id="autotoc_md10"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date </th><th class="markdownTableHeadNone">Programmer </th><th class="markdownTableHeadNone">Comments  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2002-11-05 </td><td class="markdownTableBodyNone">Gilbert </td><td class="markdownTableBodyNone">Initial  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-12-23 </td><td class="markdownTableBodyNone">Gilbert </td><td class="markdownTableBodyNone">Added complex spherical harmonic packing  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2003-08-27 </td><td class="markdownTableBodyNone">Gilbert </td><td class="markdownTableBodyNone">Added support for new templates using PNG and JPEG2000 algorithms/templates.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2004-11-29 </td><td class="markdownTableBodyNone">Gilbert </td><td class="markdownTableBodyNone">JPEG2000 now can use WMO Template 5.40 PNG can use WMO Template 5.41. Added packing algorithm check.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2005-05-10 </td><td class="markdownTableBodyNone">Gilbert </td><td class="markdownTableBodyNone">Imposed minimum size on cpack.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2009-01-14 </td><td class="markdownTableBodyNone">Vuong </td><td class="markdownTableBodyNone">Changed structure name template to gtemplate  </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cgrib</td><td>Char array that contains the GRIB2 message to which sections 4 through 7 should be added. Must be allocated large enough to store the entire GRIB2 message. </td></tr>
    <tr><td class="paramname">ipdsnum</td><td>Product Definition Template Number (see <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table4-0.shtml">Code Table 4.0</a>). </td></tr>
    <tr><td class="paramname">ipdstmpl</td><td>Contains the data values for the Product Definition Template specified by ipdsnum. </td></tr>
    <tr><td class="paramname">coordlist</td><td>Array containg floating point values intended to document the vertical discretisation associated to model data on hybrid coordinate vertical levels. </td></tr>
    <tr><td class="paramname">numcoord</td><td>number of values in array coordlist. </td></tr>
    <tr><td class="paramname">idrsnum</td><td>Data Representation Template Number (see <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table5-0.shtml">Code Table 5.0</a>). </td></tr>
    <tr><td class="paramname">idrstmpl</td><td>The data values for the Data Representation Template specified by idrsnum. Note that some values in this template (eg. reference values, number of bits, etc...) may be changed by the data packing algorithms. Use this to specify scaling factors and order of spatial differencing, if desired. </td></tr>
    <tr><td class="paramname">fld</td><td>Array of data points to pack. </td></tr>
    <tr><td class="paramname">ngrdpts</td><td>Number of data points in grid. i.e. size of fld and bmap. </td></tr>
    <tr><td class="paramname">ibmap</td><td>Bitmap indicator (see <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table6-0.shtml">Code Table 6.0</a>)<ul>
<li>0 = bitmap applies and is included in Section 6.</li>
<li>1-253 = Predefined bitmap applies.</li>
<li>254 = Previously defined bitmap applies to this field.</li>
<li>255 = Bit map does not apply to this product. </li>
</ul>
</td></tr>
    <tr><td class="paramname">bmap</td><td>Integer array containing bitmap to be added (if ibmap = 0).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>&gt; 0 Current size of updated GRIB2 message</li>
<li><a class="el" href="grib2_8h.html#a9627c88b7c7dd863cb3af9fb3e10011b" title="GRIB message was not initialized - call g2_create() first.">G2_ADD_MSG_INIT</a> GRIB message was not initialized. Need to call routine <a class="el" href="g2__create_8c.html#a0e8970973e1cefc142240f961a796108" title="This routine initializes a new GRIB2 message and packs GRIB2 Section 0 (Indicator Section) and Sectio...">g2_create()</a> first.</li>
<li><a class="el" href="grib2_8h.html#a5aaef5008fd9be5c044b207231cf767f" title="GRIB message already complete.">G2_ADD_MSG_COMPLETE</a> GRIB message already complete. Cannot add new section.</li>
<li><a class="el" href="grib2_8h.html#a06d37843d3f4b3f46cb240206ce430b0" title="Sum of Section byte counts doesn&#39;t add to total byte count.">G2_BAD_SEC_COUNTS</a> Sum of Section byte counts doesn't add to total byte count.</li>
<li><a class="el" href="grib2_8h.html#a362f4c8ddcb007058bccba7eab1ff8e0" title="Previous Section was unexpected.">G2_BAD_SEC</a> Previous Section was not 3 or 7.</li>
<li><a class="el" href="grib2_8h.html#a7661683648959dad5ea1d2def2cb766d" title="In g2_addfield() could not find requested Product Definition Template.">G2_ADDFIELD_BAD_PDT</a> Could not find requested Product Definition Template.</li>
<li><a class="el" href="grib2_8h.html#a28e1af8be9f9c34241c0c8ce780c2707" title="In g2_addfield() section 3 (GDS) not previously defined in message.">G2_ADDFIELD_BAD_GDS</a> Section 3 (GDS) not previously defined in message.</li>
<li><a class="el" href="grib2_8h.html#a5a92ce5b0b8da884e2924dba7f1e1a95" title="In g2_addfield() unsupported Data Representationi Template.">G2_ADDFIELD_BAD_DRT</a> Tried to use unsupported Data Representationi Template.</li>
<li><a class="el" href="grib2_8h.html#a496eb9c096d0ecdc712ebea3ffd3a37d" title="In g2_addfield() no bitmap in the GRIB message.">G2_ADDFIELD_BAD_BITMAP</a> Specified use of a previously defined bitmap, but one does not exist in the GRIB message.</li>
<li><a class="el" href="grib2_8h.html#aaead77879d197777943ee9c53e0672ef" title="In g2_addfield() GDT of one of 5.50 through 5.53 required when using DRT 5.51.">G2_ADDFIELD_BAD_GDT</a> GDT of one of 5.50 through 5.53 required to pack field using DRT 5.51.</li>
<li><a class="el" href="grib2_8h.html#ad37ad5e44291e1b229321755b4838c3a" title="In g2_addfield() error packing data field.">G2_ADDFIELD_ERR</a> Error packing data field.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Note that the Sections 4 through 7 can only follow Section 3 or Section 7 in a GRIB2 message.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Stephen Gilbert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-11-05 </dd></dl>

<p class="definition">Definition at line <a class="el" href="g2__addfield_8c_source.html#l00098">98</a> of file <a class="el" href="g2__addfield_8c_source.html">g2_addfield.c</a>.</p>

<p class="reference">References <a class="el" href="cmplxpack_8c_source.html#l00036">cmplxpack()</a>, <a class="el" href="grib2__int_8h_source.html#l00053">gtemplate::ext</a>, <a class="el" href="grib2__int_8h_source.html#l00049">gtemplate::extlen</a>, <a class="el" href="pdstemplates_8c_source.html#l00329">extpdstemplate()</a>, <a class="el" href="grib2_8h_source.html#l00311">G2_ADD_MSG_COMPLETE</a>, <a class="el" href="grib2_8h_source.html#l00310">G2_ADD_MSG_INIT</a>, <a class="el" href="grib2_8h_source.html#l00316">G2_ADDFIELD_BAD_BITMAP</a>, <a class="el" href="grib2_8h_source.html#l00315">G2_ADDFIELD_BAD_DRT</a>, <a class="el" href="grib2_8h_source.html#l00314">G2_ADDFIELD_BAD_GDS</a>, <a class="el" href="grib2_8h_source.html#l00317">G2_ADDFIELD_BAD_GDT</a>, <a class="el" href="grib2_8h_source.html#l00313">G2_ADDFIELD_BAD_PDT</a>, <a class="el" href="grib2_8h_source.html#l00318">G2_ADDFIELD_ERR</a>, <a class="el" href="grib2_8h_source.html#l00300">G2_BAD_SEC</a>, <a class="el" href="grib2_8h_source.html#l00312">G2_BAD_SEC_COUNTS</a>, <a class="el" href="util_8c_source.html#l00026">g2c_check_msg()</a>, <a class="el" href="grib2_8h_source.html#l00330">G2C_MSG_COMPLETE</a>, <a class="el" href="grib2_8h_source.html#l00329">G2C_NOT_GRIB</a>, <a class="el" href="gbits_8c_source.html#l00020">gbit()</a>, <a class="el" href="getdim_8c_source.html#l00029">getdim()</a>, <a class="el" href="drstemplates_8c_source.html#l00166">getdrstemplate()</a>, <a class="el" href="pdstemplates_8c_source.html#l00281">getpdstemplate()</a>, <a class="el" href="getpoly_8c_source.html#l00040">getpoly()</a>, <a class="el" href="jpcpack_8c_source.html#l00253">jpcpack()</a>, <a class="el" href="grib2__int_8h_source.html#l00043">gtemplate::map</a>, <a class="el" href="grib2__int_8h_source.html#l00039">gtemplate::maplen</a>, <a class="el" href="mkieee_8c_source.html#l00022">mkieee()</a>, <a class="el" href="grib2__int_8h_source.html#l00046">gtemplate::needext</a>, <a class="el" href="pngpack_8c_source.html#l00224">pngpack()</a>, <a class="el" href="gbits_8c_source.html#l00038">sbit()</a>, <a class="el" href="gbits_8c_source.html#l00114">sbits()</a>, <a class="el" href="simpack_8c_source.html#l00034">simpack()</a>, and <a class="el" href="specpack_8c_source.html#l00033">specpack()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="g2__addfield_8c.html">g2_addfield.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
